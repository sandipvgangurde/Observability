# âš™ï¸ **Part 2: Grafana + Prometheus (Metrics Monitoring Stack)**

---

## **ğŸ¯ Objective**

Install **Prometheus** to collect system and app metrics, and connect it to **Grafana** for beautiful dashboards.

---

## ğŸ§© **Step 1: Prerequisites**

Ensure Docker is installed (from Part 1). If not:

```bash
sudo apt-get update
sudo apt-get install -y docker.io
sudo systemctl enable docker
sudo systemctl start docker
```

---

## ğŸ“ **Step 2: Create Directory and Config File**

```bash
mkdir ~/prometheus_config
cd ~/prometheus_config
```

Create a basic Prometheus config file:

```bash
cat <<EOF > prometheus-config.yml
global:
  scrape_interval: 4s  # Collect metrics every 4 seconds

scrape_configs:
  - job_name: prometheus
    static_configs:
      - targets: ["localhost:9090"]
EOF
```

> ğŸ§  *This means Prometheus scrapes its own metrics for now. Later you can add more targets (like Node Exporter, apps, etc.).*

---

## ğŸ³ **Step 3: Run Prometheus Using Docker**

```bash
docker run -d --name prometheus \
  -p 9090:9090 \
  -v $(pwd)/prometheus-config.yml:/etc/prometheus/prometheus.yml \
  prom/prometheus
```


## ğŸ“Š **Step 4: Add Grafana Dashboards for Prometheus**

### **ğŸ§­ Three Key Ways to Import Dashboards**

#### **1ï¸âƒ£ Import via Dashboard ID**

1. Go to **Dashboards â†’ Import**
2. Enter any of the following popular IDs:

   * **Node Exporter Full:** `1860`
   * **Prometheus 2.0 Stats:** `3662`
   * **Docker Container Monitoring:** `179`
3. Click **Load**, select **Prometheus** as the data source â†’ **Import**

#### **2ï¸âƒ£ Import via JSON File**

If youâ€™ve exported a `.json` file before:

1. Click **Dashboards â†’ Import â†’ Upload JSON**
2. Select your JSON file â†’ Set data source â†’ Import

#### **3ï¸âƒ£ Build a Custom Dashboard**

1. Go to **+ â†’ Dashboard â†’ Add Panel**
2. Example PromQL query:

   ```promql
   node_cpu_seconds_total{mode="system"}
   ```
3. Add visualization type (Graph, Stat, Gauge)
4. Click **Apply** â†’ Save dashboard.

---

### ğŸ’¡ Recommended Dashboards for Metrics:

| Dashboard Name          | ID   | Description                     |
| ----------------------- | ---- | ------------------------------- |
| Node Exporter Full      | 1860 | System metrics: CPU, RAM, Disk  |
| Prometheus 2.0 Overview | 3662 | Prometheus performance overview |
| Docker Monitoring       | 179  | Container resource metrics      |
| Blackbox Exporter       | 7587 | Network endpoint availability   |

---

## ğŸ§° **Step 5: Add Node Exporter (Optional)**

Collect host metrics:

```bash
docker run -d --name node-exporter -p 9100:9100 prom/node-exporter
```

Update Prometheus config:

```yaml
  - job_name: node_exporter
    static_configs:
      - targets: ["localhost:9100"]
```

Restart Prometheus:

```bash
docker restart prometheus
```

---

## ğŸ§  **Step 6: Organize Dashboards**

* Use **folders** to group dashboards (e.g., Logs / Metrics)
* Use **Variables** (e.g., `$server`, `$job`) for reusable panels
* Share dashboards by exporting as JSON or sharing public links

---

# ğŸ§¾ **Summary Table**

| Component     | Purpose                 | Default Port | Installed In      |
| ------------- | ----------------------- | ------------ | ----------------- |
| Grafana       | Visualization dashboard | 3000         | Both Parts        |
| Loki          | Log aggregation         | 3100         | Part 1            |
| Promtail      | Log collection          | â€”            | Part 1            |
| Prometheus    | Metrics collector       | 9090         | Part 2            |
| Node Exporter | System metrics          | 9100         | Optional (Part 2) |

---
